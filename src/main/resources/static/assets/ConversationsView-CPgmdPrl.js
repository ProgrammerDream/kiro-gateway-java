import{h as V,o as k,c as I,a as d,b as t,w as a,g as m,r as p,u as z,f as u,t as s}from"./index-DX4KFW2y.js";import{a as N}from"./index-D7fQwz9Q.js";const D={class:"content-card"},P={style:{"margin-bottom":"16px",display:"flex",gap:"12px"}},f=20,M={__name:"ConversationsView",setup(A){const h=z(),g=m([]),v=m(0),_=m(1),r=m({apiType:"",success:""});async function i(){try{const l=await N.getRequestLogs({limit:f,offset:(_.value-1)*f});g.value=l.data||[],v.value=l.total||0}catch(l){console.error(l)}}function w(l){h.push(`/admin/conversations/${l.traceId}`)}function x(l){return l?new Date(l).toLocaleString("zh-CN"):"-"}return V(i),(l,n)=>{const c=p("el-option"),b=p("el-select"),o=p("el-table-column"),y=p("el-tag"),T=p("el-table"),C=p("el-pagination");return k(),I("div",null,[n[3]||(n[3]=d("div",{class:"page-header"},[d("h1",null,"对话记录")],-1)),d("div",D,[d("div",P,[t(b,{modelValue:r.value.apiType,"onUpdate:modelValue":n[0]||(n[0]=e=>r.value.apiType=e),placeholder:"API类型",clearable:"",style:{width:"120px"},onChange:i},{default:a(()=>[t(c,{label:"OpenAI",value:"openai"}),t(c,{label:"Claude",value:"claude"})]),_:1},8,["modelValue"]),t(b,{modelValue:r.value.success,"onUpdate:modelValue":n[1]||(n[1]=e=>r.value.success=e),placeholder:"状态",clearable:"",style:{width:"100px"},onChange:i},{default:a(()=>[t(c,{label:"成功",value:!0}),t(c,{label:"失败",value:!1})]),_:1},8,["modelValue"])]),t(T,{data:g.value,stripe:"",onRowClick:w,style:{cursor:"pointer"}},{default:a(()=>[t(o,{prop:"timestamp",label:"时间",width:"180"},{default:a(({row:e})=>[u(s(x(e.timestamp)),1)]),_:1}),t(o,{prop:"apiType",label:"API",width:"80"},{default:a(({row:e})=>[t(y,{type:e.apiType==="openai"?"":"warning",size:"small"},{default:a(()=>[u(s(e.apiType),1)]),_:2},1032,["type"])]),_:1}),t(o,{prop:"model",label:"模型",width:"200"}),t(o,{prop:"accountName",label:"账号",width:"120"}),t(o,{label:"Tokens",width:"120"},{default:a(({row:e})=>[u(s(e.inputTokens)+" / "+s(e.outputTokens),1)]),_:1}),t(o,{prop:"durationMs",label:"耗时",width:"80"},{default:a(({row:e})=>[u(s(e.durationMs)+"ms",1)]),_:1}),t(o,{prop:"success",label:"状态",width:"80"},{default:a(({row:e})=>[t(y,{type:e.success?"success":"danger",size:"small"},{default:a(()=>[u(s(e.success?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1}),t(o,{prop:"stream",label:"流式",width:"60"},{default:a(({row:e})=>[u(s(e.stream?"是":"否"),1)]),_:1}),t(o,{prop:"traceId",label:"TraceID",width:"160"})]),_:1},8,["data"]),t(C,{style:{"margin-top":"16px","justify-content":"flex-end"},layout:"total, prev, pager, next",total:v.value,"page-size":f,"current-page":_.value,"onUpdate:currentPage":n[2]||(n[2]=e=>_.value=e),onCurrentChange:i},null,8,["total","current-page"])])])}}};export{M as default};
